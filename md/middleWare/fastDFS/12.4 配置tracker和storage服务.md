## 配置tracker和storage服务

### 说明

tracker和storage都是同一个fastdfs的主程序的两个不同概念，配置不同的配置文件就可以设定为tracker或者storage

### 配置tracker

* #### 修改tracker.conf配置文件

```
# 切换至配置文件目录下
cd /etc/fdfs
# 打开tracker配置文件
vim ./tracker.conf
# 修改以下配置信息
base_path=/usr/local/fastdfs/tracker
# 创建上述配置的路径
mkdir /usr/local/fastdfs/tracker -p
```

* #### 启动和停止tracker服务

```
# 启动
/usr/bin/fdfs_trackerd /etc/fdfs/tracker.conf
# 停止
/usr/bin/stop.sh /etc/fdfs/tracker.conf
```



### 配置storage

* #### 修改storage配置文件

```
# 切换至配置文件目录下
cd /etc/fdfs
# 打开storage配置文件
vim ./storage.conf

# 修改以下配置信息 开始
# 修改组名
group_name=architect
# 修改storage的工作空间
base_path=/usr/local/fastdfs/storage
# 修改storage的存储空间
store_path0=/usr/local/fastdfs/storage
# 修改tracker的地址和端口号，用于心跳
tracker_server=192.168.31.4:22122
# 后续结合nginx的一个对外服务端口号
http.server_port=8888
# 修改以下配置信息 结束

# 创建上述配置的路径
mkdir /usr/local/fastdfs/storage -p
```

* #### 启动和停止storage

```
# 启动前必须先启动tracker
# 启动
/usr/bin/fdfs_storaged /etc/fdfs/storage.conf
# 停止
/usr/bin/stop.sh /etc/fdfs/storage.conf
```



### 测试上传

* #### 修改的client配置文件

```
# 切换至配置文件目录下
cd /etc/fdfs
# 打开client配置文件
vim ./client.conf
# 修改以下配置信息
base_path=/usr/local/fastdfs/client
tracker_server=192.168.31.4:22122
# 创建上述配置的路径
mkdir /usr/local/fastdfs/client -p
```

* #### 测试

```
# 预先下载一张图片，会下载至当前目录
wget https://www.imooc.com/static/img/index/logo.png 
# 上传命令
./fdfs_test /etc/fdfs/client.conf upload /home/logo.png
```



